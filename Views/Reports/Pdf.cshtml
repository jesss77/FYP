@model FYP.ViewModels.Reports.FullReportVM
@{
    Layout = null; // simplified layout for PDF
}

<div style="font-family: Arial, sans-serif; padding: 20px;">
    <h1 style="text-align:center">Reports</h1>
    @if(Model.FromDate != null || Model.ToDate != null)
    {
        <p style="text-align:center; font-size:0.9rem; color:#666;">Range: @(Model.FromDate?.ToString("yyyy-MM-dd") ?? "-")  -  @(Model.ToDate?.ToString("yyyy-MM-dd") ?? "-")</p>
    }

    <h3>Peak Reservation Times</h3>
    <table style="width:100%; border-collapse: collapse;">
        <thead>
            <tr>
                <th style="border: 1px solid #ddd; padding:8px;">Hour</th>
                <th style="border: 1px solid #ddd; padding:8px;">Count</th>
            </tr>
        </thead>
        <tbody>
            @foreach(var p in Model.PeakTimes)
            {
                <tr>
                    <td style="border:1px solid #ddd; padding:8px;">@p.Hour:00</td>
                    <td style="border:1px solid #ddd; padding:8px;">@p.Count</td>
                </tr>
            }
        </tbody>
    </table>

    <h3>Capacity vs Availability</h3>
    <table style="width:100%; border-collapse: collapse; margin-top:8px;">
        <thead>
            <tr>
                <th style="border:1px solid #ddd; padding:8px;">Date</th>
                <th style="border:1px solid #ddd; padding:8px;">Total Capacity</th>
                <th style="border:1px solid #ddd; padding:8px;">Reserved Seats</th>
                <th style="border:1px solid #ddd; padding:8px;">Availability</th>
            </tr>
        </thead>
        <tbody>
            @foreach(var c in Model.CapacityAvailability)
            {
                <tr>
                    <td style="border:1px solid #ddd; padding:8px;">@c.Date.ToString("dd/MM/yyyy")</td>
                    <td style="border:1px solid #ddd; padding:8px;">@c.TotalCapacity</td>
                    <td style="border:1px solid #ddd; padding:8px;">@c.ReservedSeats</td>
                    <td style="border:1px solid #ddd; padding:8px;">@c.Availability</td>
                </tr>
            }
        </tbody>
    </table>

    <h3>Most Frequently Used Tables</h3>
    <table style="width:100%; border-collapse: collapse; margin-top:8px;">
        <thead>
            <tr>
                <th style="border:1px solid #ddd; padding:8px;">Table Number</th>
                <th style="border:1px solid #ddd; padding:8px;">Times Used</th>
            </tr>
        </thead>
        <tbody>
            @foreach(var t in Model.PeakTables)
            {
                <tr>
                    <td style="border:1px solid #ddd; padding:8px;">@t.TableNumber</td>
                    <td style="border:1px solid #ddd; padding:8px;">@t.TimesUsed</td>
                </tr>
            }
        </tbody>
    </table>

    <h3>Key Performance Indicators</h3>
    <table style="width:100%; border-collapse: collapse; margin-top:8px;">
        <thead>
            <tr>
                <th style="border:1px solid #ddd; padding:8px; background-color: #f2f2f2;">Metric</th>
                <th style="border:1px solid #ddd; padding:8px; background-color: #f2f2f2;">Value</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td style="border:1px solid #ddd; padding:8px;">Total Reservations</td>
                <td style="border:1px solid #ddd; padding:8px;"><strong>@Model.TotalReservations</strong></td>
            </tr>
            <tr>
                <td style="border:1px solid #ddd; padding:8px;">Total Guests Served</td>
                <td style="border:1px solid #ddd; padding:8px;"><strong>@Model.TotalGuests</strong></td>
            </tr>
            <tr>
                <td style="border:1px solid #ddd; padding:8px;">Confirmed Reservations</td>
                <td style="border:1px solid #ddd; padding:8px;"><strong>@Model.ConfirmedReservations</strong></td>
            </tr>
            <tr>
                <td style="border:1px solid #ddd; padding:8px;">Cancellation Rate</td>
                <td style="border:1px solid #ddd; padding:8px;"><strong>@Model.CancellationRate%</strong></td>
            </tr>
            <tr>
                <td style="border:1px solid #ddd; padding:8px;">Average Booking Lead Time</td>
                <td style="border:1px solid #ddd; padding:8px;"><strong>@Model.AverageLeadTimeDays days</strong></td>
            </tr>
            <tr>
                <td style="border:1px solid #ddd; padding:8px;">Average Party Size</td>
                <td style="border:1px solid #ddd; padding:8px;"><strong>@Model.AveragePartySize.AveragePartySize</strong> (Based on @Model.AveragePartySize.Count reservations)</td>
            </tr>
            <tr>
                <td style="border:1px solid #ddd; padding:8px;">Walk-in Reservations</td>
                <td style="border:1px solid #ddd; padding:8px;"><strong>@Model.WalkInCount</strong></td>
            </tr>
            <tr>
                <td style="border:1px solid #ddd; padding:8px;">Pre-booked Reservations</td>
                <td style="border:1px solid #ddd; padding:8px;"><strong>@Model.PreBookedCount</strong></td>
            </tr>
            <tr>
                <td style="border:1px solid #ddd; padding:8px;">No-show Rate</td>
                <td style="border:1px solid #ddd; padding:8px;"><strong>@Model.NoShowRate%</strong></td>
            </tr>
            @if(Model.BusiestDay != null)
            {
                <tr>
                    <td style="border:1px solid #ddd; padding:8px;">Busiest Day</td>
                    <td style="border:1px solid #ddd; padding:8px;"><strong>@Model.BusiestDay.Date.ToString("dd/MM/yyyy") (@Model.BusiestDay.DayOfWeek)</strong> - @Model.BusiestDay.ReservationCount reservations</td>
                </tr>
            }
        </tbody>
    </table>

    <h3>Reservation Time Distribution</h3>
    <table style="width:100%; border-collapse: collapse; margin-top:8px;">
        <thead>
            <tr>
                <th style="border:1px solid #ddd; padding:8px;">Time Period</th>
                <th style="border:1px solid #ddd; padding:8px;">Reservations</th>
                <th style="border:1px solid #ddd; padding:8px;">Total Guests</th>
            </tr>
        </thead>
        <tbody>
            @foreach(var time in Model.ReservationTimeDistribution)
            {
                <tr>
                    <td style="border:1px solid #ddd; padding:8px;">@time.TimeLabel</td>
                    <td style="border:1px solid #ddd; padding:8px;">@time.Count</td>
                    <td style="border:1px solid #ddd; padding:8px;">@time.TotalGuests</td>
                </tr>
            }
        </tbody>
    </table>

    <h3>Booking Lead Time Distribution</h3>
    <table style="width:100%; border-collapse: collapse; margin-top:8px;">
        <thead>
            <tr>
                <th style="border:1px solid #ddd; padding:8px;">Timeframe</th>
                <th style="border:1px solid #ddd; padding:8px;">Count</th>
                <th style="border:1px solid #ddd; padding:8px;">Percentage</th>
            </tr>
        </thead>
        <tbody>
            @foreach(var lead in Model.BookingLeadTime)
            {
                <tr>
                    <td style="border:1px solid #ddd; padding:8px;">@lead.TimeframeLabel</td>
                    <td style="border:1px solid #ddd; padding:8px;">@lead.Count</td>
                    <td style="border:1px solid #ddd; padding:8px;">@lead.Percentage%</td>
                </tr>
            }
        </tbody>
    </table>

    <h3>Reservation Status Distribution</h3>
    <table style="width:100%; border-collapse: collapse; margin-top:8px;">
        <thead>
            <tr>
                <th style="border:1px solid #ddd; padding:8px;">Status</th>
                <th style="border:1px solid #ddd; padding:8px;">Count</th>
                <th style="border:1px solid #ddd; padding:8px;">Percentage</th>
            </tr>
        </thead>
        <tbody>
            @foreach(var status in Model.StatusDistribution)
            {
                <tr>
                    <td style="border:1px solid #ddd; padding:8px;">@status.StatusName</td>
                    <td style="border:1px solid #ddd; padding:8px;">@status.Count</td>
                    <td style="border:1px solid #ddd; padding:8px;">@status.Percentage%</td>
                </tr>
            }
        </tbody>
    </table>
</div>
